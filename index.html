<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landing Page</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
  <div id="map"></div>

  <!-- Logo Navigation -->
  <div id="logo-nav">
    <button class="nav-btn" onclick="slideLeft()">&#9664;</button>
    <div id="logo-container" onmousedown="startDrag(event)" onmousemove="dragMove(event)" onmouseup="stopDrag()" onmouseleave="stopDrag()">
      <div class="logo" onclick="goToPage(1)">
        <img src="images/SAPS_badge.svg.png" alt="Logo 1">
      </div>
      <div class="logo" onclick="goToPage(2)">
        <img src="images/bonizluu-fav.png" alt="Logo 2">
      </div>
      <div class="logo" onclick="goToPage(3)">
        <img src="images/hillbrow.jpeg" alt="Logo 3">
      </div>
      <div class="logo" onclick="goToPage(5)">
        <img src="images/cpf.png" alt="Logo 5">
      </div>
      <div class="logo" onclick="goToPage(4)">
        <img src="images/pulse.jpeg" alt="Logo 4">
      </div>
      <div class="logo" onclick="goToPage(5)">
        <img src="images/cpf.png" alt="Logo 5">
      </div>
    </div>
    <button class="nav-btn" onclick="slideRight()">&#9654;</button>
  </div>

  <!-- Modal Button -->
  <button id="modal-button" onclick="toggleWidgets()">Toggle Widgets</button>

  <!-- Widgets -->
  <div id="widget-container">
    <div class="column">
      <div class="box">
        <h3>Heading 1</h3>
        <select>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
        </select>
      </div>
      <div class="box">
        <h3>Heading 2</h3>
        <select>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
        </select>
      </div>
    </div>

    <div class="column">
      <div class="box">
        <h3>Heading 1</h3>
        <select>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
        </select>
      </div>
      <div class="box">
        <h3>Heading 2</h3>
        <select>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
        </select>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Leaflet map initialization
    const map = L.map('map').fitWorld();


    map.locate({ setView: true, maxZoom: 16 });

      // Handle location found
      function onLocationFound(e) {
      L.marker(e.latlng).addTo(map)
        .bindPopup("You are here: " + e.latlng.toString())
        .openPopup();
    }

    // Handle location error
    function onLocationError(e) {
      alert(e.message);
    }

    map.on('locationfound', onLocationFound);
    map.on('locationerror', onLocationError);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Handle map click to open the incident form
    map.on('click', function(e) {
      const formPopupContent = `
        <form id="incidentForm" onsubmit="submitIncidentForm(event, '${e.latlng.lat}', '${e.latlng.lng}')">
          <label for="address">Address/Location:</label>
          <input type="text" id="address" name="address" placeholder="Enter address" required>
          <label for="incidentType">Incident Type:</label>
          <select id="incidentType" name="incidentType" required>
            <option value="crime">Crime</option>
            <option value="accident">Accident</option>
            <option value="hazard">Hazard</option>
            <option value="other">Other</option>
          </select>
          <label for="notes">Additional Notes:</label>
          <textarea id="notes" name="notes" placeholder="Describe the incident..."></textarea>
          <button type="submit">Report Incident</button>
        </form>
      `;

      L.popup()
        .setLatLng(e.latlng)
        .setContent(formPopupContent)
        .openOn(map);
    });

    // Function to handle form submission
    function submitIncidentForm(event, lat, lng) {
      event.preventDefault();

      const address = document.getElementById('address').value;
      const incidentType = document.getElementById('incidentType').value;
      const notes = document.getElementById('notes').value;

      // Process and store the alert/incident data here (e.g., send it to a database)
      console.log("Incident reported at:", lat, lng);
      console.log("Address:", address);
      console.log("Type:", incidentType);
      console.log("Notes:", notes);

      // Close the popup
      map.closePopup();

      // Add a marker to the map to represent the incident
      L.marker([lat, lng]).addTo(map)
        .bindPopup(`
          <strong>Incident Reported</strong><br>
          <strong>Location:</strong> ${address}<br>
          <strong>Type:</strong> ${incidentType}<br>
          <strong>Notes:</strong> ${notes}
        `).openPopup();
    }

      function onLocationFound(e) {
      L.marker(e.latlng).addTo(map)
        .bindPopup("You are here: " + e.latlng.toString())
        .openPopup();
    }

    function onLocationError(e) {
      alert(e.message);
    }

    map.on('locationfound', onLocationFound);
    map.on('locationerror', onLocationError);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Toggle widgets display
    function toggleWidgets() {
      const widgetContainer = document.getElementById('widget-container');
      widgetContainer.style.display = widgetContainer.style.display === 'flex' ? 'none' : 'flex';
    }

    // Slide logo navigation
    function slideLeft() {
      const container = document.getElementById('logo-container');
      container.scrollBy({ left: -50, behavior: 'smooth' });
    }

    function slideRight() {
      const container = document.getElementById('logo-container');
      container.scrollBy({ left: 50, behavior: 'smooth' });
    }

    // Placeholder function for navigating to pages
    function goToPage(pageNumber) {
      alert("Navigating to page " + pageNumber);
    }

    let isDragging = false;
    let startX;
    let scrollLeft;

    function startDrag(e) {
      isDragging = true;
      startX = e.pageX - document.getElementById('logo-container').offsetLeft;
      scrollLeft = document.getElementById('logo-container').scrollLeft;
      document.getElementById('logo-container').classList.add('dragging');
    }

    function dragMove(e) {
      if (!isDragging) return;
      e.preventDefault();
      const x = e.pageX - document.getElementById('logo-container').offsetLeft;
      const walk = (x - startX) * 2; // scroll speed
      document.getElementById('logo-container').scrollLeft = scrollLeft - walk;
    }

    function stopDrag() {
      isDragging = false;
      document.getElementById('logo-container').classList.remove('dragging');
    }
  </script>
</body>
</html>





